<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>芬与萌的甜蜜空间</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #89CFF0;
            --light-blue: #B6E6FF;
            --light-green: #C9E4C5;
            --accent-color: #6EB5FF;
            --light-color: #F8FDFF;
            --dark-color: #2C5F7D;
            --text-color: #333;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans SC', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background: linear-gradient(135deg, var(--light-blue) 0%, var(--light-green) 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* 密码保护层 */
        #password-protection {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--light-blue) 0%, var(--light-green) 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .password-container {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 40px;
            box-shadow: var(--shadow);
            text-align: center;
            max-width: 500px;
            width: 90%;
            backdrop-filter: blur(10px);
        }
        
        .password-container h2 {
            color: var(--dark-color);
            margin-bottom: 20px;
            font-size: 2rem;
        }
        
        .password-container p {
            margin-bottom: 30px;
            color: #666;
        }
        
        .password-input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--primary-blue);
            border-radius: 10px;
            font-size: 1.1rem;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .password-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(110, 181, 255, 0.2);
        }
        
        .password-btn {
            padding: 15px 30px;
            background-color: var(--primary-blue);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
            margin-bottom: 15px;
        }
        
        .password-btn:hover {
            background-color: var(--accent-color);
        }
        
        .password-error {
            color: #ff6b6b;
            margin-top: 10px;
            display: none;
        }
        
        /* 头部样式 */
        header {
            background: linear-gradient(to right, var(--primary-blue), var(--accent-color));
            color: white;
            padding: 1.5rem 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo i {
            font-size: 2rem;
        }
        
        .logo h1 {
            font-size: 1.8rem;
            font-weight: 700;
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 2rem;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            font-size: 1.1rem;
            transition: var(--transition);
            padding: 5px 10px;
            border-radius: 5px;
        }
        
        nav a:hover, nav a.active {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* 主要内容区 */
        main {
            padding: 2rem 0;
            opacity: 0;
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--dark-color);
            position: relative;
            padding-bottom: 10px;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background-color: var(--primary-blue);
            border-radius: 2px;
        }
        
        /* 首页样式 */
        #home {
            text-align: center;
            padding: 3rem 0;
        }
        
        .couple-name {
            font-size: 3rem;
            color: var(--dark-color);
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .tagline {
            font-size: 1.2rem;
            color: var(--dark-color);
            margin-bottom: 2rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .photo-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 2rem;
        }
        
        .photo-item {
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            height: 280px;
            position: relative;
        }
        
        .photo-item:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }
        
        .photo-item:hover img {
            transform: scale(1.05);
        }
        
        .photo-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            color: white;
            padding: 20px 15px 10px;
            transform: translateY(5px);
            opacity: 0;
            transition: var(--transition);
        }
        
        .photo-item:hover .photo-caption {
            transform: translateY(0);
            opacity: 1;
        }
        
        /* 关于她页面 */
        #about-her {
            display: none;
        }
        
        .about-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 2rem;
        }
        
        @media (max-width: 768px) {
            .about-container {
                grid-template-columns: 1fr;
            }
        }
        
        .about-card {
            background-color: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            box-shadow: var(--shadow);
            padding: 25px;
            transition: var(--transition);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .about-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .about-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .about-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary-blue), var(--accent-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: white;
        }
        
        .about-title {
            flex: 1;
            font-size: 1.3rem;
            color: var(--dark-color);
        }
        
        .about-content ul {
            list-style-type: none;
        }
        
        .about-content li {
            margin-bottom: 10px;
            padding-left: 10px;
            position: relative;
        }
        
        .about-content li:before {
            content: '•';
            color: var(--primary-blue);
            position: absolute;
            left: -10px;
            font-size: 1.2rem;
        }
        
        /* 纪念日样式 - 改进版 */
        #milestones {
            display: none;
        }
        
        .milestones-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin-top: 2rem;
        }
        
        .milestone-card {
            background-color: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: var(--transition);
            backdrop-filter: blur(5px);
            position: relative;
        }
        
        .milestone-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .milestone-icon {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--primary-blue), var(--accent-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 1.8rem;
        }
        
        .milestone-title {
            font-size: 1.3rem;
            color: var(--dark-color);
            margin-bottom: 15px;
        }
        
        .milestone-description {
            font-size: 0.9rem;
            color: #777;
            margin-bottom: 20px;
            min-height: 40px;
        }
        
        .timers-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }
        
        .timer-box {
            padding: 15px;
            border-radius: 10px;
            background-color: rgba(255, 255, 255, 0.9);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
        }
        
        .timer-label {
            font-size: 0.9rem;
            color: #777;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        
        .timer-value {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .count-up .timer-value {
            color: #51cf66; /* 绿色表示正计时 */
        }
        
        .count-down .timer-value {
            color: #ff6b6b; /* 红色表示倒计时 */
        }
        
        .timer-unit {
            font-size: 0.9rem;
            color: #777;
            margin-left: 3px;
        }
        
        .timer-details {
            font-size: 0.8rem;
            color: #999;
            margin-top: 5px;
        }
        
        .milestone-date {
            color: #777;
            font-size: 0.9rem;
            margin-top: 10px;
        }
        
        /* 底部样式 */
        footer {
            background-color: var(--dark-color);
            color: white;
            padding: 2rem 0;
            margin-top: 3rem;
            text-align: center;
        }
        
        .footer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
        }
        
        .heartbeat {
            color: var(--primary-blue);
            animation: heartbeat 1.5s infinite;
        }
        
        @keyframes heartbeat {
            0% { transform: scale(1); }
            5% { transform: scale(1.2); }
            10% { transform: scale(1.1); }
            15% { transform: scale(1.3); }
            50% { transform: scale(1); }
            100% { transform: scale(1); }
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            nav ul {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background-color: var(--primary-blue);
                flex-direction: column;
                padding: 1rem;
                gap: 0;
                box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
            }
            
            nav ul.show {
                display: flex;
            }
            
            nav li {
                width: 100%;
            }
            
            nav a {
                display: block;
                padding: 15px;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .couple-name {
                font-size: 2.2rem;
            }
            
            .photo-gallery {
                grid-template-columns: 1fr;
            }
            
            .milestones-container {
                grid-template-columns: 1fr;
            }
        }
        
        /* 浮动爱心 */
        .floating-heart {
            position: absolute;
            font-size: 1.5rem;
            color: var(--primary-blue);
            opacity: 0.7;
            z-index: -1;
            animation: float 15s infinite linear;
        }
        
        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); opacity: 0.7; }
            100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }
        
        .edit-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            padding: 5px 8px;
            border-radius: 5px;
            transition: var(--transition);
            color: var(--primary-blue);
        }
        
        .edit-btn:hover {
            background-color: rgba(137, 207, 240, 0.1);
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background-color: var(--primary-blue);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--accent-color);
        }
        
        /* 模态框样式 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            box-shadow: var(--shadow);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .modal-title {
            font-size: 1.3rem;
            color: var(--dark-color);
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #777;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            font-family: 'Noto Sans SC', sans-serif;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(137, 207, 240, 0.2);
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .checkbox-group input {
            width: auto;
        }
        
        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 30px;
        }
        
        .modal-btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .modal-btn-primary {
            background-color: var(--primary-blue);
            color: white;
            border: none;
        }
        
        .modal-btn-primary:hover {
            background-color: var(--accent-color);
        }
        
        .modal-btn-secondary {
            background-color: #eee;
            color: #333;
            border: 1px solid #ddd;
        }
        
        .modal-btn-secondary:hover {
            background-color: #ddd;
        }
        
        /* 通知样式 */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 500;
            z-index: 3000;
            display: flex;
            align-items: center;
            gap: 10px;
            opacity: 0;
            transform: translateX(100px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        
        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }
        
        .notification-success {
            background-color: #51cf66;
        }
        
        .notification-error {
            background-color: #ff6b6b;
        }
    </style>
</head>
<body>
    <!-- 浮动爱心背景 -->
    <div id="floating-hearts"></div>
    
    <!-- 密码保护层 -->
    <div id="password-protection">
        <div class="password-container">
            <h2>芬与萌的甜蜜空间</h2>
            <p>请输入密码查看我们的专属空间</p>
            <input type="password" class="password-input" id="password-input" placeholder="请输入密码" autocomplete="off">
            <button class="password-btn" id="password-submit">进入我们的空间</button>
            <div class="password-error" id="password-error">密码错误，请重新输入</div>
            <p style="font-size: 0.9rem; color: #777; margin-top: 20px;">提示：密码是我们相遇和在一起的日子</p>
        </div>
    </div>
    
    <!-- 网站内容 -->
    <div id="site-content" style="display: none;">
        <!-- 头部 -->
        <header>
            <div class="container header-content">
                <div class="logo">
                    <i class="fas fa-heart"></i>
                    <h1>芬与萌的甜蜜空间</h1>
                </div>
                
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                
                <nav>
                    <ul id="mainMenu">
                        <li><a href="#" class="nav-link active" data-section="home">首页</a></li>
                        <li><a href="#" class="nav-link" data-section="about-her">关于她</a></li>
                        <li><a href="#" class="nav-link" data-section="milestones">纪念日</a></li>
                    </ul>
                </nav>
            </div>
        </header>
        
        <!-- 主要内容 -->
        <main class="container">
            <!-- 首页 -->
            <section id="home" class="section active">
                <h2 class="couple-name">芬 ❤️ 萌</h2>
                <p class="tagline">这里记录着我们每一个甜蜜瞬间，从相遇、相知到相爱，每一个回忆都值得珍藏。这是我们专属的小天地，只属于我们两个人的故事。</p>
                
                <div class="photo-gallery">
                    <div class="photo-item">
                        <img src="https://images.unsplash.com/photo-1518568814500-bf0f8d125f46?ixlib=rb-4.0.3&auto=format&fit=crop&w=687&q=80" alt="我们的合照">
                        <div class="photo-caption">
                            <h3>第一次旅行</h3>
                            <p>2023年5月 · 海边</p>
                        </div>
                    </div>
                    <div class="photo-item">
                        <img src="https://images.unsplash.com/photo-1539635278303-d4002c07eae3?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80" alt="我们的合照">
                        <div class="photo-caption">
                            <h3>周年纪念日</h3>
                            <p>2023年8月 · 餐厅</p>
                        </div>
                    </div>
                    <div class="photo-item">
                        <img src="https://images.unsplash.com/photo-1542037104857-ffbb0b9155fb?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80" alt="我们的合照">
                        <div class="photo-caption">
                            <h3>日常甜蜜</h3>
                            <p>2023年10月 · 家中</p>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-primary" id="edit-home-btn">
                        <i class="fas fa-edit"></i> 编辑首页内容
                    </button>
                </div>
            </section>
            
            <!-- 关于她 -->
            <section id="about-her" class="section">
                <h2 class="section-title">关于她 
                    <button class="edit-btn" id="edit-about-her-title" title="编辑标题">
                        <i class="fas fa-edit"></i>
                    </button>
                </h2>
                
                <div class="about-container" id="about-her-container">
                    <!-- 关于她卡片将通过JS动态生成 -->
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-primary" id="add-about-card">
                        <i class="fas fa-plus"></i> 添加新卡片
                    </button>
                </div>
            </section>
            
            <!-- 纪念日 -->
            <section id="milestones" class="section">
                <h2 class="section-title">纪念日
                    <button class="edit-btn" id="edit-milestones-title" title="编辑标题">
                        <i class="fas fa-edit"></i>
                    </button>
                </h2>
                
                <div style="text-align: center; margin-bottom: 20px;">
                    <button class="btn btn-primary" id="add-milestone-btn">
                        <i class="fas fa-plus"></i> 添加纪念日
                    </button>
                </div>
                
                <div class="milestones-container" id="milestonesContainer">
                    <!-- 纪念日卡片将通过JS动态生成 -->
                </div>
            </section>
        </main>
        
        <!-- 底部 -->
        <footer>
            <div class="container footer-content">
                <p>© 2025 我们的甜蜜空间 | 专属于 <span class="heartbeat">芬与萌</span> 的爱情小窝</p>
                <p>"我的茶一杯500，但对你免费" ❤️ "我好友位收费，但对你例外"</p>
                <button class="edit-btn" id="edit-footer" style="color: white;" title="编辑底部文字">
                    <i class="fas fa-edit"></i> 编辑
                </button>
            </div>
        </footer>
    </div>
    
    <!-- 编辑模态框 -->
    <div id="edit-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modal-title">编辑内容</h3>
                <button class="close-modal" id="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="edit-form">
                    <!-- 表单内容将根据编辑的内容动态生成 -->
                </form>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" id="cancel-edit">取消</button>
                <button class="modal-btn modal-btn-primary" id="save-edit">保存</button>
            </div>
        </div>
    </div>
    
    <!-- 通知 -->
    <div id="notification" class="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notification-text">保存成功</span>
    </div>

    <script>
        // 创建浮动爱心
        function createFloatingHearts() {
            const heartsContainer = document.getElementById('floating-hearts');
            for (let i = 0; i < 15; i++) {
                const heart = document.createElement('div');
                heart.className = 'floating-heart';
                heart.innerHTML = '<i class="fas fa-heart"></i>';
                heart.style.left = Math.random() * 100 + 'vw';
                heart.style.top = Math.random() * 100 + 'vh';
                heart.style.animationDelay = Math.random() * 15 + 's';
                heart.style.fontSize = (Math.random() * 1.5 + 1) + 'rem';
                heartsContainer.appendChild(heart);
            }
        }
        
        // 本地存储管理
        const StorageManager = {
            // 检查是否有存储的数据
            hasStoredData: function(key) {
                return localStorage.getItem(key) !== null;
            },
            
            // 获取存储的数据
            getStoredData: function(key, defaultValue = null) {
                const data = localStorage.getItem(key);
                return data ? JSON.parse(data) : defaultValue;
            },
            
            // 保存数据到本地存储
            saveData: function(key, data) {
                try {
                    localStorage.setItem(key, JSON.stringify(data));
                    return true;
                } catch (e) {
                    console.error('保存数据失败:', e);
                    // 如果存储空间不足，尝试清理一些旧数据
                    this.clearOldData();
                    // 再次尝试保存
                    try {
                        localStorage.setItem(key, JSON.stringify(data));
                        return true;
                    } catch (e2) {
                        console.error('再次保存数据失败:', e2);
                        return false;
                    }
                }
            },
            
            // 清理旧数据（如果需要）
            clearOldData: function() {
                // 这里可以根据需要实现清理逻辑
                // 例如：清理一些临时数据或不太重要的数据
            },
            
            // 清空所有数据
            clearAllData: function() {
                localStorage.clear();
            }
        };
        
        // 默认数据
        const defaultData = {
            home: {
                coupleName: "芬 ❤️ 萌",
                tagline: "这里记录着我们每一个甜蜜瞬间，从相遇、相知到相爱，每一个回忆都值得珍藏。这是我们专属的小天地，只属于我们两个人的故事。",
                photos: [
                    {
                        src: "https://images.unsplash.com/photo-1518568814500-bf0f8d125f46?ixlib=rb-4.0.3&auto=format&fit=crop&w=687&q=80",
                        caption: "第一次旅行",
                        date: "2023年5月 · 海边"
                    },
                    {
                        src: "https://images.unsplash.com/photo-1539635278303-d4002c07eae3?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80",
                        caption: "周年纪念日",
                        date: "2023年8月 · 餐厅"
                    },
                    {
                        src: "https://images.unsplash.com/photo-1542037104857-ffbb0b9155fb?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80",
                        caption: "日常甜蜜",
                        date: "2023年10月 · 家中"
                    }
                ]
            },
            
            aboutHer: {
                title: "关于她",
                cards: [
                    {
                        id: 1,
                        title: "基本信息",
                        icon: "fas fa-user",
                        items: [
                            "生日：2003年4月23日",
                            "家乡：江西赣州",
                            "称呼：芬、冷、饭饭",
                            "饮食习惯：家里准时准点吃饭（中午12点，晚上18点）",
                            "天气偏好：喜欢多云，不喜欢下雨天（泥土的味道）"
                        ]
                    },
                    {
                        id: 2,
                        title: "她的喜好",
                        icon: "fas fa-heart",
                        items: [
                            "明星：白鹿、肖战",
                            "喜欢的茶：古茗的云岭茉莉白",
                            "最喜欢的食物：螺蛳粉",
                            "想去的地方：海边",
                            "性格偏好：喜欢偏执，只要一人；喜欢需要；喜欢在乎；喜欢独一无二"
                        ]
                    },
                    {
                        id: 3,
                        title: "她的不喜欢",
                        icon: "fas fa-thumbs-down",
                        items: [
                            "影视题材：不喜欢骨科题材",
                            "感情上：不喜欢精神出轨",
                            "食物：不喜欢吃太甜的",
                            "肉类：不喜欢吃肉",
                            "节日食物：不喜欢月饼",
                            "蔬菜：不喜欢生的番茄",
                            "早餐：几乎不吃早餐"
                        ]
                    },
                    {
                        id: 4,
                        title: "我们的故事",
                        icon: "fas fa-history",
                        items: [
                            "初遇：2025年4月6日 - 游戏中相识，她叫'茶泡饭'，我以为她是说茶不一样要贵点，没想到是自我介绍。",
                            "在一起：2025年5月27日 - 我们正式成为彼此的唯一天。"
                        ]
                    }
                ]
            },
            
            milestones: {
                title: "纪念日",
                items: [
                    {
                        id: 1,
                        title: "在一起纪念日",
                        description: "我们成为彼此的唯一",
                        date: "2025-05-27",
                        icon: "fas fa-heart",
                        type: "anniversary",
                        repeatYearly: true,
                        countUp: true,
                        countDown: true
                    },
                    {
                        id: 2,
                        title: "芬的生日",
                        description: "祝我的宝贝生日快乐",
                        date: "2003-04-23",
                        icon: "fas fa-birthday-cake",
                        type: "birthday",
                        repeatYearly: true,
                        countUp: true,
                        countDown: true
                    },
                    {
                        id: 3,
                        title: "初遇纪念日",
                        description: "茶泡饭与南書的相遇",
                        date: "2025-04-06",
                        icon: "fas fa-gamepad",
                        type: "anniversary",
                        repeatYearly: true,
                        countUp: true,
                        countDown: true
                    },
                    {
                        id: 4,
                        title: "第一个情人节",
                        description: "我们的第一个情人节",
                        date: "2025-02-14",
                        icon: "fas fa-kiss-wink-heart",
                        type: "anniversary",
                        repeatYearly: true,
                        countUp: true,
                        countDown: true
                    }
                ]
            },
            
            footer: {
                text1: "© 2025 我们的甜蜜空间 | 专属于 <span class='heartbeat'>芬与萌</span> 的爱情小窝",
                text2: "\"我的茶一杯500，但对你免费\" ❤️ \"我好友位收费，但对你例外\""
            }
        };
        
        // 应用数据
        let appData = {
            home: null,
            aboutHer: null,
            milestones: null,
            footer: null
        };
        
        // 初始化应用数据
        function initAppData() {
            // 尝试从本地存储加载数据
            appData.home = StorageManager.getStoredData('sweetSpace_home', defaultData.home);
            appData.aboutHer = StorageManager.getStoredData('sweetSpace_aboutHer', defaultData.aboutHer);
            appData.milestones = StorageManager.getStoredData('sweetSpace_milestones', defaultData.milestones);
            appData.footer = StorageManager.getStoredData('sweetSpace_footer', defaultData.footer);
        }
        
        // 保存应用数据
        function saveAppData() {
            StorageManager.saveData('sweetSpace_home', appData.home);
            StorageManager.saveData('sweetSpace_aboutHer', appData.aboutHer);
            StorageManager.saveData('sweetSpace_milestones', appData.milestones);
            StorageManager.saveData('sweetSpace_footer', appData.footer);
        }
        
        // 计算时间差
        function calculateTimeDifference(targetDate, isBirthday = false) {
            const now = new Date();
            const target = new Date(targetDate);
            
            // 如果是生日，计算下一个生日
            if (isBirthday) {
                const currentYear = now.getFullYear();
                target.setFullYear(currentYear);
                
                // 如果今年生日已经过了，计算明年的生日
                if (target < now) {
                    target.setFullYear(currentYear + 1);
                }
            }
            
            const diff = target - now;
            
            if (diff < 0 && !isBirthday) {
                // 对于非生日的事件，如果已经过去，计算下一个周年
                target.setFullYear(target.getFullYear() + 1);
                return calculateTimeDifference(target.toISOString().split('T')[0], false);
            }
            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            return {
                days: Math.max(0, days),
                hours: Math.max(0, hours),
                minutes: Math.max(0, minutes),
                seconds: Math.max(0, seconds),
                totalMs: diff
            };
        }
        
        // 计算已经过去的时间（正计时）
        function calculateTimePassed(startDate) {
            const now = new Date();
            const start = new Date(startDate);
            
            const diff = now - start;
            
            const years = now.getFullYear() - start.getFullYear();
            const months = (now.getFullYear() - start.getFullYear()) * 12 + (now.getMonth() - start.getMonth());
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            
            return {
                years: Math.max(0, years),
                months: Math.max(0, months),
                days: Math.max(0, days),
                hours: Math.max(0, hours),
                minutes: Math.max(0, minutes),
                totalMs: diff
            };
        }
        
        // 格式化时间显示
        function formatTime(time, isCountUp = false) {
            if (isCountUp) {
                if (time.years > 0) {
                    return `${time.years}年${time.months % 12}个月${time.days % 30}天`;
                } else if (time.months > 0) {
                    return `${time.months}个月${time.days % 30}天`;
                } else if (time.days > 0) {
                    return `${time.days}天${time.hours}小时`;
                } else {
                    return `${time.hours}小时${time.minutes}分钟`;
                }
            } else {
                if (time.days > 0) {
                    return `${time.days}天${time.hours}小时`;
                } else if (time.hours > 0) {
                    return `${time.hours}小时${time.minutes}分钟`;
                } else if (time.minutes > 0) {
                    return `${time.minutes}分钟${time.seconds}秒`;
                } else {
                    return `${time.seconds}秒`;
                }
            }
        }
        
        // 生成纪念日卡片
        function generateMilestoneCard(milestone) {
            const isBirthday = milestone.type === "birthday";
            
            // 计算时间
            const timePassed = calculateTimePassed(milestone.date);
            const timeLeft = calculateTimeDifference(milestone.date, isBirthday);
            
            const card = document.createElement('div');
            card.className = 'milestone-card';
            card.dataset.id = milestone.id;
            
            let timersHTML = '';
            
            // 正计时（已经过去的时间）
            if (milestone.countUp) {
                let passedDescription = "";
                if (isBirthday) {
                    passedDescription = `芬已经 ${timePassed.years} 岁了`;
                } else {
                    passedDescription = `已经过去 ${formatTime(timePassed, true)}`;
                }
                
                timersHTML += `
                    <div class="timer-box count-up">
                        <div class="timer-label">
                            <i class="fas fa-clock"></i> 正计时
                        </div>
                        <div class="timer-value">${isBirthday ? timePassed.years : formatTime(timePassed, true)}</div>
                        <div class="timer-details">${passedDescription}</div>
                    </div>
                `;
            }
            
            // 倒计时（距离下一个纪念日）
            if (milestone.countDown) {
                let countdownDescription = "";
                if (isBirthday) {
                    countdownDescription = `距离 ${timePassed.years + 1} 岁生日还有`;
                } else {
                    countdownDescription = "距离下一个纪念日还有";
                }
                
                timersHTML += `
                    <div class="timer-box count-down">
                        <div class="timer-label">
                            <i class="fas fa-hourglass-half"></i> 倒计时
                        </div>
                        <div class="timer-value">${formatTime(timeLeft, false)}</div>
                        <div class="timer-details">${countdownDescription}</div>
                    </div>
                `;
            }
            
            card.innerHTML = `
                <div class="milestone-icon">
                    <i class="${milestone.icon}"></i>
                </div>
                <h3 class="milestone-title">${milestone.title}</h3>
                <div class="milestone-description">${milestone.description}</div>
                <div class="timers-container">
                    ${timersHTML}
                </div>
                <p class="milestone-date">日期: ${milestone.date} ${isBirthday ? '(每年)' : ''}</p>
                <div style="margin-top: 15px;">
                    <button class="edit-btn edit-milestone" data-id="${milestone.id}" title="编辑纪念日">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="edit-btn delete-milestone" data-id="${milestone.id}" title="删除纪念日" style="color: #ff6b6b;">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
            
            return card;
        }
        
        // 更新所有纪念日计时器
        function updateAllMilestoneTimers() {
            const milestoneCards = document.querySelectorAll('.milestone-card');
            
            milestoneCards.forEach(card => {
                const milestoneId = parseInt(card.dataset.id);
                const milestone = appData.milestones.items.find(m => m.id === milestoneId);
                
                if (milestone) {
                    const isBirthday = milestone.type === "birthday";
                    
                    // 计算时间
                    const timePassed = calculateTimePassed(milestone.date);
                    const timeLeft = calculateTimeDifference(milestone.date, isBirthday);
                    
                    // 更新正计时
                    const countUpBox = card.querySelector('.count-up');
                    if (countUpBox && milestone.countUp) {
                        const timerValue = countUpBox.querySelector('.timer-value');
                        const timerDetails = countUpBox.querySelector('.timer-details');
                        
                        if (timerValue) {
                            timerValue.textContent = isBirthday ? timePassed.years : formatTime(timePassed, true);
                        }
                        
                        if (timerDetails) {
                            if (isBirthday) {
                                timerDetails.textContent = `芬已经 ${timePassed.years} 岁了`;
                            } else {
                                timerDetails.textContent = `已经过去 ${formatTime(timePassed, true)}`;
                            }
                        }
                    }
                    
                    // 更新倒计时
                    const countDownBox = card.querySelector('.count-down');
                    if (countDownBox && milestone.countDown) {
                        const timerValue = countDownBox.querySelector('.timer-value');
                        const timerDetails = countDownBox.querySelector('.timer-details');
                        
                        if (timerValue) {
                            timerValue.textContent = formatTime(timeLeft, false);
                        }
                        
                        if (timerDetails) {
                            if (isBirthday) {
                                timerDetails.textContent = `距离 ${timePassed.years + 1} 岁生日还有`;
                            } else {
                                timerDetails.textContent = "距离下一个纪念日还有";
                            }
                        }
                    }
                }
            });
        }
        
        // 初始化纪念日
        function initMilestones() {
            const container = document.getElementById('milestonesContainer');
            container.innerHTML = '';
            
            // 按日期排序（最近的要到来的在前面）
            appData.milestones.items.sort((a, b) => {
                const aTime = calculateTimeDifference(a.date, a.type === "birthday").totalMs;
                const bTime = calculateTimeDifference(b.date, b.type === "birthday").totalMs;
                return aTime - bTime;
            });
            
            // 生成卡片
            appData.milestones.items.forEach(milestone => {
                const card = generateMilestoneCard(milestone);
                container.appendChild(card);
            });
            
            // 添加事件监听
            document.querySelectorAll('.edit-milestone').forEach(btn => {
                btn.addEventListener('click', function() {
                    const milestoneId = parseInt(this.dataset.id);
                    openEditMilestoneModal(milestoneId);
                });
            });
            
            document.querySelectorAll('.delete-milestone').forEach(btn => {
                btn.addEventListener('click', function() {
                    const milestoneId = parseInt(this.dataset.id);
                    if (confirm('确定要删除这个纪念日吗？')) {
                        deleteMilestone(milestoneId);
                    }
                });
            });
        }
        
        // 编辑纪念日
        function openEditMilestoneModal(milestoneId) {
            const milestone = milestoneId ? 
                appData.milestones.items.find(m => m.id === milestoneId) : 
                {
                    id: appData.milestones.items.length > 0 ? Math.max(...appData.milestones.items.map(m => m.id)) + 1 : 1,
                    title: "",
                    description: "",
                    date: "",
                    icon: "fas fa-heart",
                    type: "anniversary",
                    repeatYearly: true,
                    countUp: true,
                    countDown: true
                };
            
            const isNew = !milestoneId;
            
            // 设置模态框标题
            document.getElementById('modal-title').textContent = isNew ? '添加纪念日' : '编辑纪念日';
            
            // 生成表单
            const form = document.getElementById('edit-form');
            form.innerHTML = `
                <div class="form-group">
                    <label for="edit-title">纪念日标题</label>
                    <input type="text" id="edit-title" class="form-control" value="${milestone.title}" required>
                </div>
                <div class="form-group">
                    <label for="edit-description">描述</label>
                    <textarea id="edit-description" class="form-control" rows="3">${milestone.description}</textarea>
                </div>
                <div class="form-group">
                    <label for="edit-date">日期 (YYYY-MM-DD)</label>
                    <input type="text" id="edit-date" class="form-control" value="${milestone.date}" placeholder="2025-05-27" required>
                </div>
                <div class="form-group">
                    <label for="edit-type">类型</label>
                    <select id="edit-type" class="form-control">
                        <option value="anniversary" ${milestone.type === 'anniversary' ? 'selected' : ''}>纪念日</option>
                        <option value="birthday" ${milestone.type === 'birthday' ? 'selected' : ''}>生日</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="edit-icon">图标</label>
                    <select id="edit-icon" class="form-control">
                        <option value="fas fa-heart" ${milestone.icon === 'fas fa-heart' ? 'selected' : ''}>爱心</option>
                        <option value="fas fa-birthday-cake" ${milestone.icon === 'fas fa-birthday-cake' ? 'selected' : ''}>生日蛋糕</option>
                        <option value="fas fa-gamepad" ${milestone.icon === 'fas fa-gamepad' ? 'selected' : ''}>游戏手柄</option>
                        <option value="fas fa-kiss-wink-heart" ${milestone.icon === 'fas fa-kiss-wink-heart' ? 'selected' : ''}>亲吻</option>
                        <option value="fas fa-calendar" ${milestone.icon === 'fas fa-calendar' ? 'selected' : ''}>日历</option>
                        <option value="fas fa-gift" ${milestone.icon === 'fas fa-gift' ? 'selected' : ''}>礼物</option>
                    </select>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" id="edit-repeat" ${milestone.repeatYearly ? 'checked' : ''}>
                        <label for="edit-repeat">每年重复</label>
                    </div>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" id="edit-countup" ${milestone.countUp ? 'checked' : ''}>
                        <label for="edit-countup">显示正计时</label>
                    </div>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" id="edit-countdown" ${milestone.countDown ? 'checked' : ''}>
                        <label for="edit-countdown">显示倒计时</label>
                    </div>
                </div>
                <input type="hidden" id="edit-id" value="${milestone.id}">
            `;
            
            // 显示模态框
            document.getElementById('edit-modal').style.display = 'flex';
            
            // 保存按钮事件
            document.getElementById('save-edit').onclick = function() {
                const editedMilestone = {
                    id: parseInt(document.getElementById('edit-id').value),
                    title: document.getElementById('edit-title').value,
                    description: document.getElementById('edit-description').value,
                    date: document.getElementById('edit-date').value,
                    icon: document.getElementById('edit-icon').value,
                    type: document.getElementById('edit-type').value,
                    repeatYearly: document.getElementById('edit-repeat').checked,
                    countUp: document.getElementById('edit-countup').checked,
                    countDown: document.getElementById('edit-countdown').checked
                };
                
                if (!editedMilestone.title || !editedMilestone.date) {
                    showNotification('标题和日期不能为空', 'error');
                    return;
                }
                
                if (!editedMilestone.date.match(/^\d{4}-\d{2}-\d{2}$/)) {
                    showNotification('日期格式不正确，请输入 YYYY-MM-DD 格式', 'error');
                    return;
                }
                
                if (isNew) {
                    appData.milestones.items.push(editedMilestone);
                } else {
                    const index = appData.milestones.items.findIndex(m => m.id === milestoneId);
                    if (index !== -1) {
                        appData.milestones.items[index] = editedMilestone;
                    }
                }
                
                saveAppData();
                initMilestones();
                closeModal();
                showNotification(isNew ? '纪念日添加成功' : '纪念日修改成功');
            };
        }
        
        // 删除纪念日
        function deleteMilestone(milestoneId) {
            const index = appData.milestones.items.findIndex(m => m.id === milestoneId);
            if (index !== -1) {
                appData.milestones.items.splice(index, 1);
                saveAppData();
                initMilestones();
                showNotification('纪念日删除成功');
            }
        }
        
        // 生成关于她卡片
        function generateAboutCard(cardData) {
            const card = document.createElement('div');
            card.className = 'about-card';
            card.dataset.id = cardData.id;
            
            let itemsHTML = '';
            cardData.items.forEach(item => {
                itemsHTML += `<li>${item}</li>`;
            });
            
            card.innerHTML = `
                <div class="about-header">
                    <div class="about-icon">
                        <i class="${cardData.icon}"></i>
                    </div>
                    <h3 class="about-title">${cardData.title}</h3>
                    <button class="edit-btn edit-about-card" data-id="${cardData.id}" title="编辑卡片">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="edit-btn delete-about-card" data-id="${cardData.id}" title="删除卡片" style="color: #ff6b6b;">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                <div class="about-content">
                    <ul>${itemsHTML}</ul>
                </div>
            `;
            
            return card;
        }
        
        // 初始化关于她
        function initAboutHer() {
            const container = document.getElementById('about-her-container');
            container.innerHTML = '';
            
            // 更新标题
            document.querySelector('#about-her .section-title').childNodes[0].textContent = appData.aboutHer.title;
            
            // 生成卡片
            appData.aboutHer.cards.forEach(cardData => {
                const card = generateAboutCard(cardData);
                container.appendChild(card);
            });
            
            // 添加事件监听
            document.querySelectorAll('.edit-about-card').forEach(btn => {
                btn.addEventListener('click', function() {
                    const cardId = parseInt(this.dataset.id);
                    openEditAboutCardModal(cardId);
                });
            });
            
            document.querySelectorAll('.delete-about-card').forEach(btn => {
                btn.addEventListener('click', function() {
                    const cardId = parseInt(this.dataset.id);
                    if (confirm('确定要删除这个卡片吗？')) {
                        deleteAboutCard(cardId);
                    }
                });
            });
        }
        
        // 编辑关于她卡片
        function openEditAboutCardModal(cardId) {
            const card = cardId ? 
                appData.aboutHer.cards.find(c => c.id === cardId) : 
                {
                    id: appData.aboutHer.cards.length > 0 ? Math.max(...appData.aboutHer.cards.map(c => c.id)) + 1 : 1,
                    title: "",
                    icon: "fas fa-heart",
                    items: [""]
                };
            
            const isNew = !cardId;
            
            // 设置模态框标题
            document.getElementById('modal-title').textContent = isNew ? '添加卡片' : '编辑卡片';
            
            // 生成项目字段
            let itemsFields = '';
            card.items.forEach((item, index) => {
                itemsFields += `
                    <div class="form-group item-group">
                        <label for="edit-item-${index}">项目 ${index + 1}</label>
                        <input type="text" id="edit-item-${index}" class="form-control item-input" value="${item}">
                        ${index > 0 ? '<button type="button" class="edit-btn remove-item" data-index="' + index + '" style="margin-top: 5px;">删除此项</button>' : ''}
                    </div>
                `;
            });
            
            // 生成表单
            const form = document.getElementById('edit-form');
            form.innerHTML = `
                <div class="form-group">
                    <label for="edit-card-title">卡片标题</label>
                    <input type="text" id="edit-card-title" class="form-control" value="${card.title}" required>
                </div>
                <div class="form-group">
                    <label for="edit-card-icon">图标</label>
                    <select id="edit-card-icon" class="form-control">
                        <option value="fas fa-user" ${card.icon === 'fas fa-user' ? 'selected' : ''}>用户</option>
                        <option value="fas fa-heart" ${card.icon === 'fas fa-heart' ? 'selected' : ''}>爱心</option>
                        <option value="fas fa-thumbs-down" ${card.icon === 'fas fa-thumbs-down' ? 'selected' : ''}>不喜欢</option>
                        <option value="fas fa-history" ${card.icon === 'fas fa-history' ? 'selected' : ''}>历史</option>
                        <option value="fas fa-star" ${card.icon === 'fas fa-star' ? 'selected' : ''}>星星</option>
                        <option value="fas fa-music" ${card.icon === 'fas fa-music' ? 'selected' : ''}>音乐</option>
                        <option value="fas fa-film" ${card.icon === 'fas fa-film' ? 'selected' : ''}>电影</option>
                        <option value="fas fa-utensils" ${card.icon === 'fas fa-utensils' ? 'selected' : ''}>餐具</option>
                    </select>
                </div>
                <div id="items-container">
                    ${itemsFields}
                </div>
                <div style="margin-top: 15px;">
                    <button type="button" class="btn btn-primary" id="add-item-btn">
                        <i class="fas fa-plus"></i> 添加项目
                    </button>
                </div>
                <input type="hidden" id="edit-card-id" value="${card.id}">
            `;
            
            // 显示模态框
            document.getElementById('edit-modal').style.display = 'flex';
            
            // 添加项目按钮事件
            document.getElementById('add-item-btn').onclick = function() {
                const container = document.getElementById('items-container');
                const index = container.querySelectorAll('.item-group').length;
                
                const newItem = document.createElement('div');
                newItem.className = 'form-group item-group';
                newItem.innerHTML = `
                    <label for="edit-item-${index}">项目 ${index + 1}</label>
                    <input type="text" id="edit-item-${index}" class="form-control item-input" value="">
                    <button type="button" class="edit-btn remove-item" data-index="${index}" style="margin-top: 5px;">删除此项</button>
                `;
                
                container.appendChild(newItem);
                
                // 重新绑定删除按钮事件
                newItem.querySelector('.remove-item').addEventListener('click', function() {
                    this.parentElement.remove();
                });
            };
            
            // 绑定现有的删除按钮事件
            document.querySelectorAll('.remove-item').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.parentElement.remove();
                });
            });
            
            // 保存按钮事件
            document.getElementById('save-edit').onclick = function() {
                const title = document.getElementById('edit-card-title').value;
                const icon = document.getElementById('edit-card-icon').value;
                
                // 收集所有项目
                const items = [];
                document.querySelectorAll('.item-input').forEach(input => {
                    if (input.value.trim() !== '') {
                        items.push(input.value);
                    }
                });
                
                if (!title || items.length === 0) {
                    showNotification('标题和至少一个项目是必需的', 'error');
                    return;
                }
                
                const editedCard = {
                    id: parseInt(document.getElementById('edit-card-id').value),
                    title: title,
                    icon: icon,
                    items: items
                };
                
                if (isNew) {
                    appData.aboutHer.cards.push(editedCard);
                } else {
                    const index = appData.aboutHer.cards.findIndex(c => c.id === cardId);
                    if (index !== -1) {
                        appData.aboutHer.cards[index] = editedCard;
                    }
                }
                
                saveAppData();
                initAboutHer();
                closeModal();
                showNotification(isNew ? '卡片添加成功' : '卡片修改成功');
            };
        }
        
        // 删除关于她卡片
        function deleteAboutCard(cardId) {
            const index = appData.aboutHer.cards.findIndex(c => c.id === cardId);
            if (index !== -1) {
                appData.aboutHer.cards.splice(index, 1);
                saveAppData();
                initAboutHer();
                showNotification('卡片删除成功');
            }
        }
        
        // 初始化首页
        function initHome() {
            // 更新情侣名称
            document.querySelector('.couple-name').textContent = appData.home.coupleName;
            
            // 更新描述
            document.querySelector('.tagline').textContent = appData.home.tagline;
            
            // 更新图片
            const photoGallery = document.querySelector('.photo-gallery');
            photoGallery.innerHTML = '';
            
            appData.home.photos.forEach((photo, index) => {
                const photoItem = document.createElement('div');
                photoItem.className = 'photo-item';
                photoItem.innerHTML = `
                    <img src="${photo.src}" alt="${photo.caption}">
                    <div class="photo-caption">
                        <h3>${photo.caption}</h3>
                        <p>${photo.date}</p>
                    </div>
                `;
                photoGallery.appendChild(photoItem);
            });
        }
        
        // 初始化底部
        function initFooter() {
            const footerContent = document.querySelector('.footer-content');
            footerContent.innerHTML = `
                <p>${appData.footer.text1}</p>
                <p>${appData.footer.text2}</p>
                <button class="edit-btn" id="edit-footer" style="color: white;" title="编辑底部文字">
                    <i class="fas fa-edit"></i> 编辑
                </button>
            `;
            
            // 重新绑定编辑按钮事件
            document.getElementById('edit-footer').addEventListener('click', openEditFooterModal);
        }
        
        // 编辑首页
        function openEditHomeModal() {
            // 设置模态框标题
            document.getElementById('modal-title').textContent = '编辑首页内容';
            
            // 生成表单
            const form = document.getElementById('edit-form');
            form.innerHTML = `
                <div class="form-group">
                    <label for="edit-couple-name">情侣名称</label>
                    <input type="text" id="edit-couple-name" class="form-control" value="${appData.home.coupleName}" required>
                </div>
                <div class="form-group">
                    <label for="edit-tagline">首页描述</label>
                    <textarea id="edit-tagline" class="form-control" rows="4">${appData.home.tagline}</textarea>
                </div>
                <h4 style="margin: 20px 0 10px; color: var(--dark-color);">照片编辑</h4>
                <div id="photos-container">
                    ${appData.home.photos.map((photo, index) => `
                        <div class="form-group photo-group" data-index="${index}">
                            <label>照片 ${index + 1}</label>
                            <input type="text" class="form-control photo-url" value="${photo.src}" placeholder="图片链接" style="margin-bottom: 8px;">
                            <input type="text" class="form-control photo-caption" value="${photo.caption}" placeholder="标题" style="margin-bottom: 8px;">
                            <input type="text" class="form-control photo-date" value="${photo.date}" placeholder="日期">
                            ${index > 0 ? '<button type="button" class="edit-btn remove-photo" style="margin-top: 5px;">删除此照片</button>' : ''}
                        </div>
                    `).join('')}
                </div>
                <div style="margin-top: 15px;">
                    <button type="button" class="btn btn-primary" id="add-photo-btn">
                        <i class="fas fa-plus"></i> 添加照片
                    </button>
                </div>
            `;
            
            // 显示模态框
            document.getElementById('edit-modal').style.display = 'flex';
            
            // 添加照片按钮事件
            document.getElementById('add-photo-btn').onclick = function() {
                const container = document.getElementById('photos-container');
                const index = container.querySelectorAll('.photo-group').length;
                
                const newPhoto = document.createElement('div');
                newPhoto.className = 'form-group photo-group';
                newPhoto.dataset.index = index;
                newPhoto.innerHTML = `
                    <label>照片 ${index + 1}</label>
                    <input type="text" class="form-control photo-url" value="" placeholder="图片链接" style="margin-bottom: 8px;">
                    <input type="text" class="form-control photo-caption" value="" placeholder="标题" style="margin-bottom: 8px;">
                    <input type="text" class="form-control photo-date" value="" placeholder="日期">
                    <button type="button" class="edit-btn remove-photo" style="margin-top: 5px;">删除此照片</button>
                `;
                
                container.appendChild(newPhoto);
                
                // 绑定删除按钮事件
                newPhoto.querySelector('.remove-photo').addEventListener('click', function() {
                    this.parentElement.remove();
                });
            };
            
            // 绑定现有的删除按钮事件
            document.querySelectorAll('.remove-photo').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.parentElement.remove();
                });
            });
            
            // 保存按钮事件
            document.getElementById('save-edit').onclick = function() {
                const coupleName = document.getElementById('edit-couple-name').value;
                const tagline = document.getElementById('edit-tagline').value;
                
                // 收集所有照片
                const photos = [];
                document.querySelectorAll('.photo-group').forEach(group => {
                    const url = group.querySelector('.photo-url').value;
                    const caption = group.querySelector('.photo-caption').value;
                    const date = group.querySelector('.photo-date').value;
                    
                    if (url && caption && date) {
                        photos.push({
                            src: url,
                            caption: caption,
                            date: date
                        });
                    }
                });
                
                if (!coupleName || !tagline || photos.length === 0) {
                    showNotification('情侣名称、描述和至少一张照片是必需的', 'error');
                    return;
                }
                
                appData.home.coupleName = coupleName;
                appData.home.tagline = tagline;
                appData.home.photos = photos;
                
                saveAppData();
                initHome();
                closeModal();
                showNotification('首页内容修改成功');
            };
        }
        
        // 编辑关于她标题
        function openEditAboutHerTitleModal() {
            const newTitle = prompt('修改"关于她"标题:', appData.aboutHer.title);
            if (newTitle !== null && newTitle.trim() !== '') {
                appData.aboutHer.title = newTitle;
                saveAppData();
                initAboutHer();
                showNotification('标题修改成功');
            }
        }
        
        // 编辑纪念日标题
        function openEditMilestonesTitleModal() {
            const newTitle = prompt('修改"纪念日"标题:', appData.milestones.title);
            if (newTitle !== null && newTitle.trim() !== '') {
                appData.milestones.title = newTitle;
                saveAppData();
                document.querySelector('#milestones .section-title').childNodes[0].textContent = newTitle;
                showNotification('标题修改成功');
            }
        }
        
        // 编辑底部
        function openEditFooterModal() {
            // 设置模态框标题
            document.getElementById('modal-title').textContent = '编辑底部内容';
            
            // 生成表单
            const form = document.getElementById('edit-form');
            form.innerHTML = `
                <div class="form-group">
                    <label for="edit-footer-text1">第一行文字</label>
                    <textarea id="edit-footer-text1" class="form-control" rows="2">${appData.footer.text1}</textarea>
                </div>
                <div class="form-group">
                    <label for="edit-footer-text2">第二行文字</label>
                    <textarea id="edit-footer-text2" class="form-control" rows="2">${appData.footer.text2}</textarea>
                </div>
            `;
            
            // 显示模态框
            document.getElementById('edit-modal').style.display = 'flex';
            
            // 保存按钮事件
            document.getElementById('save-edit').onclick = function() {
                const text1 = document.getElementById('edit-footer-text1').value;
                const text2 = document.getElementById('edit-footer-text2').value;
                
                if (!text1 || !text2) {
                    showNotification('底部文字不能为空', 'error');
                    return;
                }
                
                appData.footer.text1 = text1;
                appData.footer.text2 = text2;
                
                saveAppData();
                initFooter();
                closeModal();
                showNotification('底部内容修改成功');
            };
        }
        
        // 关闭模态框
        function closeModal() {
            document.getElementById('edit-modal').style.display = 'none';
            document.getElementById('edit-form').innerHTML = '';
        }
        
        // 显示通知
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const text = document.getElementById('notification-text');
            
            text.textContent = message;
            notification.className = `notification notification-${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // 页面加载时初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 创建浮动爱心
            createFloatingHearts();
            
            // 初始化应用数据
            initAppData();
            
            // 初始化密码保护
            initPasswordProtection();
            
            // 初始化导航
            initNavigation();
            
            // 初始化首页
            initHome();
            
            // 初始化关于她
            initAboutHer();
            
            // 初始化纪念日
            initMilestones();
            
            // 初始化底部
            initFooter();
            
            // 初始化编辑按钮
            initEditButtons();
            
            // 开始计时器更新
            setInterval(updateAllMilestoneTimers, 1000); // 每秒更新一次
            
            // 模态框关闭按钮
            document.getElementById('close-modal').addEventListener('click', closeModal);
            document.getElementById('cancel-edit').addEventListener('click', closeModal);
            
            // 点击模态框外部关闭
            document.getElementById('edit-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal();
                }
            });
        });
        
        // 密码保护
        function initPasswordProtection() {
            const passwordProtection = document.getElementById('password-protection');
            const passwordInput = document.getElementById('password-input');
            const passwordSubmit = document.getElementById('password-submit');
            const passwordError = document.getElementById('password-error');
            const siteContent = document.getElementById('site-content');
            
            // 修改后的密码
            const correctPassword = "250406250527";
            
            // 检查是否已登录
            const isLoggedIn = localStorage.getItem('sweetSpaceLoggedIn');
            if (isLoggedIn === 'true') {
                passwordProtection.style.display = 'none';
                siteContent.style.display = 'block';
            }
            
            // 密码提交
            passwordSubmit.addEventListener('click', function() {
                if (passwordInput.value === correctPassword) {
                    // 密码正确
                    passwordProtection.style.opacity = '0';
                    setTimeout(() => {
                        passwordProtection.style.display = 'none';
                        siteContent.style.display = 'block';
                        localStorage.setItem('sweetSpaceLoggedIn', 'true');
                    }, 500);
                } else {
                    // 密码错误
                    passwordError.style.display = 'block';
                    passwordInput.value = '';
                    passwordInput.placeholder = '密码错误，请重试';
                    passwordInput.style.borderColor = '#ff6b6b';
                    
                    // 震动效果
                    passwordInput.style.animation = 'shake 0.5s';
                    setTimeout(() => {
                        passwordInput.style.animation = '';
                    }, 500);
                }
            });
            
            // 回车键提交
            passwordInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    passwordSubmit.click();
                }
            });
            
            // 添加震动动画
            const style = document.createElement('style');
            style.textContent = `
                @keyframes shake {
                    0%, 100% { transform: translateX(0); }
                    10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                    20%, 40%, 60%, 80% { transform: translateX(5px); }
                }
            `;
            document.head.appendChild(style);
        }
        
        // 导航功能
        function initNavigation() {
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('.section');
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const mainMenu = document.getElementById('mainMenu');
            
            // 导航菜单切换
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // 更新活动链接
                    navLinks.forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 显示目标部分
                    const targetSection = this.getAttribute('data-section');
                    sections.forEach(section => {
                        section.classList.remove('active');
                        if (section.id === targetSection) {
                            section.classList.add('active');
                        }
                    });
                    
                    // 移动端菜单隐藏
                    if (window.innerWidth <= 768) {
                        mainMenu.classList.remove('show');
                    }
                });
            });
            
            // 移动端菜单切换
            mobileMenuBtn.addEventListener('click', function() {
                mainMenu.classList.toggle('show');
            });
        }
        
        // 初始化编辑按钮
        function initEditButtons() {
            // 编辑首页按钮
            document.getElementById('edit-home-btn').addEventListener('click', openEditHomeModal);
            
            // 编辑关于她标题
            document.getElementById('edit-about-her-title').addEventListener('click', openEditAboutHerTitleModal);
            
            // 编辑纪念日标题
            document.getElementById('edit-milestones-title').addEventListener('click', openEditMilestonesTitleModal);
            
            // 添加关于她卡片
            document.getElementById('add-about-card').addEventListener('click', function() {
                openEditAboutCardModal();
            });
            
            // 添加纪念日按钮
            document.getElementById('add-milestone-btn').addEventListener('click', function() {
                openEditMilestoneModal();
            });
        }
    </script>
</body>
</html>
