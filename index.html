<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>芬与萌的甜蜜空间</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #89CFF0;
            --light-blue: #B6E6FF;
            --light-green: #C9E4C5;
            --accent-color: #6EB5FF;
            --light-color: #F8FDFF;
            --dark-color: #2C5F7D;
            --text-color: #333;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans SC', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background: linear-gradient(135deg, var(--light-blue) 0%, var(--light-green) 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* 密码保护层 */
        #password-protection {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--light-blue) 0%, var(--light-green) 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .password-container {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 40px;
            box-shadow: var(--shadow);
            text-align: center;
            max-width: 500px;
            width: 90%;
            backdrop-filter: blur(10px);
        }
        
        .password-container h2 {
            color: var(--dark-color);
            margin-bottom: 20px;
            font-size: 2rem;
        }
        
        .password-container p {
            margin-bottom: 30px;
            color: #666;
        }
        
        .password-input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--primary-blue);
            border-radius: 10px;
            font-size: 1.1rem;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .password-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(110, 181, 255, 0.2);
        }
        
        .password-btn {
            padding: 15px 30px;
            background-color: var(--primary-blue);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
            margin-bottom: 15px;
        }
        
        .password-btn:hover {
            background-color: var(--accent-color);
        }
        
        .password-error {
            color: #ff6b6b;
            margin-top: 10px;
            display: none;
        }
        
        /* 头部样式 */
        header {
            background: linear-gradient(to right, var(--primary-blue), var(--accent-color));
            color: white;
            padding: 1.5rem 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo i {
            font-size: 2rem;
        }
        
        .logo h1 {
            font-size: 1.8rem;
            font-weight: 700;
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 2rem;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            font-size: 1.1rem;
            transition: var(--transition);
            padding: 5px 10px;
            border-radius: 5px;
        }
        
        nav a:hover, nav a.active {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* 主要内容区 */
        main {
            padding: 2rem 0;
            opacity: 0;
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--dark-color);
            position: relative;
            padding-bottom: 10px;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background-color: var(--primary-blue);
            border-radius: 2px;
        }
        
        /* 首页样式 */
        #home {
            text-align: center;
            padding: 3rem 0;
        }
        
        .couple-name {
            font-size: 3rem;
            color: var(--dark-color);
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .tagline {
            font-size: 1.2rem;
            color: var(--dark-color);
            margin-bottom: 2rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .photo-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 2rem;
        }
        
        .photo-item {
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            height: 280px;
            position: relative;
        }
        
        .photo-item:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }
        
        .photo-item:hover img {
            transform: scale(1.05);
        }
        
        .photo-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            color: white;
            padding: 20px 15px 10px;
            transform: translateY(5px);
            opacity: 0;
            transition: var(--transition);
        }
        
        .photo-item:hover .photo-caption {
            transform: translateY(0);
            opacity: 1;
        }
        
        /* 关于她页面 */
        #about-her {
            display: none;
        }
        
        .about-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 2rem;
        }
        
        @media (max-width: 768px) {
            .about-container {
                grid-template-columns: 1fr;
            }
        }
        
        .about-card {
            background-color: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            box-shadow: var(--shadow);
            padding: 25px;
            transition: var(--transition);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .about-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        /* 纪念日样式 - 改进版 */
        #milestones {
            display: none;
        }
        
        .milestones-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin-top: 2rem;
        }
        
        .milestone-card {
            background-color: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: var(--transition);
            backdrop-filter: blur(5px);
            position: relative;
        }
        
        .milestone-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .milestone-icon {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--primary-blue), var(--accent-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 1.8rem;
        }
        
        .milestone-title {
            font-size: 1.3rem;
            color: var(--dark-color);
            margin-bottom: 15px;
        }
        
        .milestone-description {
            font-size: 0.9rem;
            color: #777;
            margin-bottom: 20px;
            min-height: 40px;
        }
        
        .timers-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }
        
        .timer-box {
            padding: 15px;
            border-radius: 10px;
            background-color: rgba(255, 255, 255, 0.9);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
        }
        
        .timer-label {
            font-size: 0.9rem;
            color: #777;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        
        .timer-value {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .count-up .timer-value {
            color: #51cf66; /* 绿色表示正计时 */
        }
        
        .count-down .timer-value {
            color: #ff6b6b; /* 红色表示倒计时 */
        }
        
        .timer-unit {
            font-size: 0.9rem;
            color: #777;
            margin-left: 3px;
        }
        
        .timer-details {
            font-size: 0.8rem;
            color: #999;
            margin-top: 5px;
        }
        
        .milestone-date {
            color: #777;
            font-size: 0.9rem;
            margin-top: 10px;
        }
        
        /* 底部样式 */
        footer {
            background-color: var(--dark-color);
            color: white;
            padding: 2rem 0;
            margin-top: 3rem;
            text-align: center;
        }
        
        .footer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
        }
        
        .heartbeat {
            color: var(--primary-blue);
            animation: heartbeat 1.5s infinite;
        }
        
        @keyframes heartbeat {
            0% { transform: scale(1); }
            5% { transform: scale(1.2); }
            10% { transform: scale(1.1); }
            15% { transform: scale(1.3); }
            50% { transform: scale(1); }
            100% { transform: scale(1); }
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            nav ul {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background-color: var(--primary-blue);
                flex-direction: column;
                padding: 1rem;
                gap: 0;
                box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
            }
            
            nav ul.show {
                display: flex;
            }
            
            nav li {
                width: 100%;
            }
            
            nav a {
                display: block;
                padding: 15px;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .couple-name {
                font-size: 2.2rem;
            }
            
            .photo-gallery {
                grid-template-columns: 1fr;
            }
            
            .milestones-container {
                grid-template-columns: 1fr;
            }
        }
        
        /* 浮动爱心 */
        .floating-heart {
            position: absolute;
            font-size: 1.5rem;
            color: var(--primary-blue);
            opacity: 0.7;
            z-index: -1;
            animation: float 15s infinite linear;
        }
        
        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); opacity: 0.7; }
            100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }
        
        .edit-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            padding: 5px 8px;
            border-radius: 5px;
            transition: var(--transition);
            color: var(--primary-blue);
        }
        
        .edit-btn:hover {
            background-color: rgba(137, 207, 240, 0.1);
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background-color: var(--primary-blue);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--accent-color);
        }
    </style>
</head>
<body>
    <!-- 浮动爱心背景 -->
    <div id="floating-hearts"></div>
    
    <!-- 密码保护层 -->
    <div id="password-protection">
        <div class="password-container">
            <h2>芬与萌的甜蜜空间</h2>
            <p>请输入密码查看我们的专属空间</p>
            <input type="password" class="password-input" id="password-input" placeholder="请输入密码" autocomplete="off">
            <button class="password-btn" id="password-submit">进入我们的空间</button>
            <div class="password-error" id="password-error">密码错误，请重新输入</div>
            <!-- 修改了密码提示 -->
            <p style="font-size: 0.9rem; color: #777; margin-top: 20px;">提示：密码是我们相遇以及在一起的日子（250406250527）</p>
        </div>
    </div>
    
    <!-- 网站内容 -->
    <div id="site-content" style="display: none;">
        <!-- 头部 -->
        <header>
            <div class="container header-content">
                <div class="logo">
                    <i class="fas fa-heart"></i>
                    <h1>芬与萌的甜蜜空间</h1>
                </div>
                
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                
                <nav>
                    <ul id="mainMenu">
                        <li><a href="#" class="nav-link active" data-section="home">首页</a></li>
                        <li><a href="#" class="nav-link" data-section="about-her">关于她</a></li>
                        <li><a href="#" class="nav-link" data-section="milestones">纪念日</a></li>
                    </ul>
                </nav>
            </div>
        </header>
        
        <!-- 主要内容 -->
        <main class="container">
            <!-- 首页 -->
            <section id="home" class="section active">
                <h2 class="couple-name">芬 ❤️ 萌</h2>
                <p class="tagline">这里记录着我们每一个甜蜜瞬间，从相遇、相知到相爱，每一个回忆都值得珍藏。这是我们专属的小天地，只属于我们两个人的故事。</p>
                
                <div class="photo-gallery">
                    <div class="photo-item">
                        <img src="https://images.unsplash.com/photo-1518568814500-bf0f8d125f46?ixlib=rb-4.0.3&auto=format&fit=crop&w=687&q=80" alt="我们的合照">
                        <div class="photo-caption">
                            <h3>第一次旅行</h3>
                            <p>2023年5月 · 海边</p>
                        </div>
                    </div>
                    <div class="photo-item">
                        <img src="https://images.unsplash.com/photo-1539635278303-d4002c07eae3?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80" alt="我们的合照">
                        <div class="photo-caption">
                            <h3>周年纪念日</h3>
                            <p>2023年8月 · 餐厅</p>
                        </div>
                    </div>
                    <div class="photo-item">
                        <img src="https://images.unsplash.com/photo-1542037104857-ffbb0b9155fb?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80" alt="我们的合照">
                        <div class="photo-caption">
                            <h3>日常甜蜜</h3>
                            <p>2023年10月 · 家中</p>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-primary" id="edit-home-btn">
                        <i class="fas fa-edit"></i> 编辑首页内容
                    </button>
                </div>
            </section>
            
            <!-- 关于她 -->
            <section id="about-her" class="section">
                <h2 class="section-title">关于她 
                    <button class="edit-btn" id="edit-about-her-title" title="编辑标题">
                        <i class="fas fa-edit"></i>
                    </button>
                </h2>
                
                <div class="about-container">
                    <div class="about-card">
                        <div class="about-header">
                            <div class="about-icon">
                                <i class="fas fa-user"></i>
                            </div>
                            <h3 class="about-title">基本信息</h3>
                            <button class="edit-btn edit-about-card" data-card="basic">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                        <div class="about-content">
                            <ul>
                                <li><strong>生日：</strong>2003年4月23日</li>
                                <li><strong>家乡：</strong>江西赣州</li>
                                <li><strong>称呼：</strong>芬、冷、饭饭</li>
                                <li><strong>饮食习惯：</strong>家里准时准点吃饭（中午12点，晚上18点）</li>
                                <li><strong>天气偏好：</strong>喜欢多云，不喜欢下雨天（泥土的味道）</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="about-card">
                        <div class="about-header">
                            <div class="about-icon">
                                <i class="fas fa-heart"></i>
                            </div>
                            <h3 class="about-title">她的喜好</h3>
                            <button class="edit-btn edit-about-card" data-card="likes">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                        <div class="about-content">
                            <ul>
                                <li><strong>明星：</strong>白鹿、肖战</li>
                                <li><strong>喜欢的茶：</strong>古茗的云岭茉莉白</li>
                                <li><strong>最喜欢的食物：</strong>螺蛳粉</li>
                                <li><strong>想去的地方：</strong>海边</li>
                                <li><strong>性格偏好：</strong>喜欢偏执，只要一人；喜欢需要；喜欢在乎；喜欢独一无二</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="about-card">
                        <div class="about-header">
                            <div class="about-icon">
                                <i class="fas fa-thumbs-down"></i>
                            </div>
                            <h3 class="about-title">她的不喜欢</h3>
                            <button class="edit-btn edit-about-card" data-card="dislikes">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                        <div class="about-content">
                            <ul>
                                <li><strong>影视题材：</strong>不喜欢骨科题材</li>
                                <li><strong>感情上：</strong>不喜欢精神出轨</li>
                                <li><strong>食物：</strong>不喜欢吃太甜的</li>
                                <li><strong>肉类：</strong>不喜欢吃肉</li>
                                <li><strong>节日食物：</strong>不喜欢月饼</li>
                                <li><strong>蔬菜：</strong>不喜欢生的番茄</li>
                                <li><strong>早餐：</strong>几乎不吃早餐</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="about-card">
                        <div class="about-header">
                            <div class="about-icon">
                                <i class="fas fa-history"></i>
                            </div>
                            <h3 class="about-title">我们的故事</h3>
                            <button class="edit-btn edit-about-card" data-card="story">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                        <div class="about-content">
                            <div style="padding: 15px;">
                                <h4 style="color: var(--primary-blue); margin-bottom: 10px;">初遇：2025年4月6日 (250406)</h4>
                                <p style="margin-bottom: 15px;">游戏中相识，她叫"茶泡饭"，我以为她是说茶不一样要贵点，没想到是自我介绍。</p>
                                
                                <h4 style="color: var(--primary-blue); margin-bottom: 10px;">在一起：2025年5月27日 (250527)</h4>
                                <p>我们正式成为彼此的唯一天。</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-primary" id="add-about-card">
                        <i class="fas fa-plus"></i> 添加新卡片
                    </button>
                </div>
            </section>
            
            <!-- 纪念日 -->
            <section id="milestones" class="section">
                <h2 class="section-title">纪念日
                    <button class="edit-btn" id="edit-milestones-title" title="编辑标题">
                        <i class="fas fa-edit"></i>
                    </button>
                </h2>
                
                <div style="text-align: center; margin-bottom: 20px;">
                    <button class="btn btn-primary" id="add-milestone-btn">
                        <i class="fas fa-plus"></i> 添加纪念日
                    </button>
                </div>
                
                <div class="milestones-container" id="milestonesContainer">
                    <!-- 纪念日卡片将通过JS动态生成 -->
                </div>
            </section>
        </main>
        
        <!-- 底部 -->
        <footer>
            <div class="container footer-content">
                <p>© 2025 我们的甜蜜空间 | 专属于 <span class="heartbeat">芬与萌</span> 的爱情小窝</p>
                <p>"我的茶一杯500，但对你免费" ❤️ "我好友位收费，但对你例外"</p>
                <button class="edit-btn" id="edit-footer" style="color: white;" title="编辑底部文字">
                    <i class="fas fa-edit"></i> 编辑
                </button>
            </div>
        </footer>
    </div>

    <script>
        // 创建浮动爱心
        function createFloatingHearts() {
            const heartsContainer = document.getElementById('floating-hearts');
            for (let i = 0; i < 15; i++) {
                const heart = document.createElement('div');
                heart.className = 'floating-heart';
                heart.innerHTML = '<i class="fas fa-heart"></i>';
                heart.style.left = Math.random() * 100 + 'vw';
                heart.style.top = Math.random() * 100 + 'vh';
                heart.style.animationDelay = Math.random() * 15 + 's';
                heart.style.fontSize = (Math.random() * 1.5 + 1) + 'rem';
                heartsContainer.appendChild(heart);
            }
        }
        
        // 纪念日数据 - 包含详细计时信息
        const milestonesData = [
            {
                id: 1,
                title: "在一起纪念日",
                description: "我们成为彼此的唯一",
                date: "2025-05-27",
                icon: "fas fa-heart",
                type: "anniversary", // 纪念日类型
                repeatYearly: true, // 每年重复
                countUp: true, // 显示正计时
                countDown: true // 显示倒计时
            },
            {
                id: 2,
                title: "芬的生日",
                description: "祝我的宝贝生日快乐",
                date: "2003-04-23",
                icon: "fas fa-birthday-cake",
                type: "birthday",
                repeatYearly: true,
                countUp: true, // 显示年龄
                countDown: true // 显示距离下一个生日
            },
            {
                id: 3,
                title: "初遇纪念日",
                description: "茶泡饭与南書的相遇",
                date: "2025-04-06",
                icon: "fas fa-gamepad",
                type: "anniversary",
                repeatYearly: true,
                countUp: true,
                countDown: true
            },
            {
                id: 4,
                title: "第一个情人节",
                description: "我们的第一个情人节",
                date: "2025-02-14",
                icon: "fas fa-kiss-wink-heart",
                type: "anniversary",
                repeatYearly: true,
                countUp: true,
                countDown: true
            }
        ];
        
        // 计算时间差
        function calculateTimeDifference(targetDate, isBirthday = false) {
            const now = new Date();
            const target = new Date(targetDate);
            
            // 如果是生日，计算下一个生日
            if (isBirthday) {
                const currentYear = now.getFullYear();
                target.setFullYear(currentYear);
                
                // 如果今年生日已经过了，计算明年的生日
                if (target < now) {
                    target.setFullYear(currentYear + 1);
                }
            }
            
            const diff = target - now;
            
            if (diff < 0 && !isBirthday) {
                // 对于非生日的事件，如果已经过去，计算下一个周年
                target.setFullYear(target.getFullYear() + 1);
                return calculateTimeDifference(target.toISOString().split('T')[0], false);
            }
            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            return {
                days: Math.max(0, days),
                hours: Math.max(0, hours),
                minutes: Math.max(0, minutes),
                seconds: Math.max(0, seconds),
                totalMs: diff
            };
        }
        
        // 计算已经过去的时间（正计时）
        function calculateTimePassed(startDate) {
            const now = new Date();
            const start = new Date(startDate);
            
            const diff = now - start;
            
            const years = now.getFullYear() - start.getFullYear();
            const months = (now.getFullYear() - start.getFullYear()) * 12 + (now.getMonth() - start.getMonth());
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            
            return {
                years: Math.max(0, years),
                months: Math.max(0, months),
                days: Math.max(0, days),
                hours: Math.max(0, hours),
                minutes: Math.max(0, minutes),
                totalMs: diff
            };
        }
        
        // 格式化时间显示
        function formatTime(time, isCountUp = false) {
            if (isCountUp) {
                if (time.years > 0) {
                    return `${time.years}年${time.months % 12}个月${time.days % 30}天`;
                } else if (time.months > 0) {
                    return `${time.months}个月${time.days % 30}天`;
                } else if (time.days > 0) {
                    return `${time.days}天${time.hours}小时`;
                } else {
                    return `${time.hours}小时${time.minutes}分钟`;
                }
            } else {
                if (time.days > 0) {
                    return `${time.days}天${time.hours}小时`;
                } else if (time.hours > 0) {
                    return `${time.hours}小时${time.minutes}分钟`;
                } else if (time.minutes > 0) {
                    return `${time.minutes}分钟${time.seconds}秒`;
                } else {
                    return `${time.seconds}秒`;
                }
            }
        }
        
        // 生成纪念日卡片
        function generateMilestoneCard(milestone) {
            const isBirthday = milestone.type === "birthday";
            
            // 计算时间
            const timePassed = calculateTimePassed(milestone.date);
            const timeLeft = calculateTimeDifference(milestone.date, isBirthday);
            
            const card = document.createElement('div');
            card.className = 'milestone-card';
            card.dataset.id = milestone.id;
            
            let timersHTML = '';
            
            // 正计时（已经过去的时间）
            if (milestone.countUp) {
                let passedDescription = "";
                if (isBirthday) {
                    passedDescription = `芬已经 ${timePassed.years} 岁了`;
                } else {
                    passedDescription = `已经过去 ${formatTime(timePassed, true)}`;
                }
                
                timersHTML += `
                    <div class="timer-box count-up">
                        <div class="timer-label">
                            <i class="fas fa-clock"></i> 正计时
                        </div>
                        <div class="timer-value">${isBirthday ? timePassed.years : formatTime(timePassed, true)}</div>
                        <div class="timer-details">${passedDescription}</div>
                    </div>
                `;
            }
            
            // 倒计时（距离下一个纪念日）
            if (milestone.countDown) {
                let countdownDescription = "";
                if (isBirthday) {
                    countdownDescription = `距离 ${timePassed.years + 1} 岁生日还有`;
                } else {
                    countdownDescription = "距离下一个纪念日还有";
                }
                
                timersHTML += `
                    <div class="timer-box count-down">
                        <div class="timer-label">
                            <i class="fas fa-hourglass-half"></i> 倒计时
                        </div>
                        <div class="timer-value">${formatTime(timeLeft, false)}</div>
                        <div class="timer-details">${countdownDescription}</div>
                    </div>
                `;
            }
            
            card.innerHTML = `
                <div class="milestone-icon">
                    <i class="${milestone.icon}"></i>
                </div>
                <h3 class="milestone-title">${milestone.title}</h3>
                <div class="milestone-description">${milestone.description}</div>
                <div class="timers-container">
                    ${timersHTML}
                </div>
                <p class="milestone-date">日期: ${milestone.date} ${isBirthday ? '(每年)' : ''}</p>
                <div style="margin-top: 15px;">
                    <button class="edit-btn edit-milestone" data-id="${milestone.id}" title="编辑纪念日">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="edit-btn delete-milestone" data-id="${milestone.id}" title="删除纪念日" style="color: #ff6b6b;">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
            
            return card;
        }
        
        // 更新所有纪念日计时器
        function updateAllMilestoneTimers() {
            const milestoneCards = document.querySelectorAll('.milestone-card');
            
            milestoneCards.forEach(card => {
                const milestoneId = parseInt(card.dataset.id);
                const milestone = milestonesData.find(m => m.id === milestoneId);
                
                if (milestone) {
                    const isBirthday = milestone.type === "birthday";
                    
                    // 计算时间
                    const timePassed = calculateTimePassed(milestone.date);
                    const timeLeft = calculateTimeDifference(milestone.date, isBirthday);
                    
                    // 更新正计时
                    const countUpBox = card.querySelector('.count-up');
                    if (countUpBox && milestone.countUp) {
                        const timerValue = countUpBox.querySelector('.timer-value');
                        const timerDetails = countUpBox.querySelector('.timer-details');
                        
                        if (timerValue) {
                            timerValue.textContent = isBirthday ? timePassed.years : formatTime(timePassed, true);
                        }
                        
                        if (timerDetails) {
                            if (isBirthday) {
                                timerDetails.textContent = `芬已经 ${timePassed.years} 岁了`;
                            } else {
                                timerDetails.textContent = `已经过去 ${formatTime(timePassed, true)}`;
                            }
                        }
                    }
                    
                    // 更新倒计时
                    const countDownBox = card.querySelector('.count-down');
                    if (countDownBox && milestone.countDown) {
                        const timerValue = countDownBox.querySelector('.timer-value');
                        const timerDetails = countDownBox.querySelector('.timer-details');
                        
                        if (timerValue) {
                            timerValue.textContent = formatTime(timeLeft, false);
                        }
                        
                        if (timerDetails) {
                            if (isBirthday) {
                                timerDetails.textContent = `距离 ${timePassed.years + 1} 岁生日还有`;
                            } else {
                                timerDetails.textContent = "距离下一个纪念日还有";
                            }
                        }
                    }
                }
            });
        }
        
        // 初始化纪念日
        function initMilestones() {
            const container = document.getElementById('milestonesContainer');
            container.innerHTML = '';
            
            // 按日期排序（最近的要到来的在前面）
            milestonesData.sort((a, b) => {
                const aTime = calculateTimeDifference(a.date, a.type === "birthday").totalMs;
                const bTime = calculateTimeDifference(b.date, b.type === "birthday").totalMs;
                return aTime - bTime;
            });
            
            // 生成卡片
            milestonesData.forEach(milestone => {
                const card = generateMilestoneCard(milestone);
                container.appendChild(card);
            });
            
            // 添加事件监听
            document.querySelectorAll('.edit-milestone').forEach(btn => {
                btn.addEventListener('click', function() {
                    const milestoneId = parseInt(this.dataset.id);
                    editMilestone(milestoneId);
                });
            });
            
            document.querySelectorAll('.delete-milestone').forEach(btn => {
                btn.addEventListener('click', function() {
                    const milestoneId = parseInt(this.dataset.id);
                    if (confirm('确定要删除这个纪念日吗？')) {
                        deleteMilestone(milestoneId);
                    }
                });
            });
            
            // 添加纪念日按钮
            document.getElementById('add-milestone-btn').addEventListener('click', addNewMilestone);
        }
        
        // 编辑纪念日
        function editMilestone(milestoneId) {
            const milestone = milestonesData.find(m => m.id === milestoneId);
            if (!milestone) return;
            
            const newTitle = prompt('修改纪念日标题:', milestone.title);
            if (newTitle !== null) {
                milestone.title = newTitle;
            }
            
            const newDate = prompt('修改日期 (YYYY-MM-DD):', milestone.date);
            if (newDate !== null && newDate.match(/^\d{4}-\d{2}-\d{2}$/)) {
                milestone.date = newDate;
            }
            
            const newDesc = prompt('修改描述:', milestone.description);
            if (newDesc !== null) {
                milestone.description = newDesc;
            }
            
            initMilestones();
        }
        
        // 删除纪念日
        function deleteMilestone(milestoneId) {
            const index = milestonesData.findIndex(m => m.id === milestoneId);
            if (index !== -1) {
                milestonesData.splice(index, 1);
                initMilestones();
            }
        }
        
        // 添加新纪念日
        function addNewMilestone() {
            const title = prompt('输入纪念日标题:');
            if (!title) return;
            
            const date = prompt('输入日期 (YYYY-MM-DD):');
            if (!date || !date.match(/^\d{4}-\d{2}-\d{2}$/)) {
                alert('日期格式不正确，请输入 YYYY-MM-DD 格式');
                return;
            }
            
            const description = prompt('输入描述:') || '';
            
            const newId = milestonesData.length > 0 ? Math.max(...milestonesData.map(m => m.id)) + 1 : 1;
            
            milestonesData.push({
                id: newId,
                title: title,
                description: description,
                date: date,
                icon: "fas fa-heart",
                type: "anniversary",
                repeatYearly: true,
                countUp: true,
                countDown: true
            });
            
            initMilestones();
        }
        
        // 页面加载时初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 创建浮动爱心
            createFloatingHearts();
            
            // 初始化密码保护
            initPasswordProtection();
            
            // 初始化导航
            initNavigation();
            
            // 初始化纪念日
            initMilestones();
            
            // 初始化编辑按钮
            initEditButtons();
            
            // 开始计时器更新
            setInterval(updateAllMilestoneTimers, 1000); // 每秒更新一次
        });
        
        // 密码保护
        function initPasswordProtection() {
            const passwordProtection = document.getElementById('password-protection');
            const passwordInput = document.getElementById('password-input');
            const passwordSubmit = document.getElementById('password-submit');
            const passwordError = document.getElementById('password-error');
            const siteContent = document.getElementById('site-content');
            
            // 修改了默认密码：从5201314改为250406250527
            const correctPassword = "250406250527"; // 相遇(250406) + 在一起(250527)
            
            // 检查是否已登录
            const isLoggedIn = localStorage.getItem('sweetSpaceLoggedIn');
            if (isLoggedIn === 'true') {
                passwordProtection.style.display = 'none';
                siteContent.style.display = 'block';
            }
            
            // 密码提交
            passwordSubmit.addEventListener('click', function() {
                if (passwordInput.value === correctPassword) {
                    // 密码正确
                    passwordProtection.style.opacity = '0';
                    setTimeout(() => {
                        passwordProtection.style.display = 'none';
                        siteContent.style.display = 'block';
                        localStorage.setItem('sweetSpaceLoggedIn', 'true');
                    }, 500);
                } else {
                    // 密码错误
                    passwordError.style.display = 'block';
                    passwordInput.value = '';
                    passwordInput.placeholder = '密码错误，请重试';
                    passwordInput.style.borderColor = '#ff6b6b';
                    
                    // 震动效果
                    passwordInput.style.animation = 'shake 0.5s';
                    setTimeout(() => {
                        passwordInput.style.animation = '';
                    }, 500);
                }
            });
            
            // 回车键提交
            passwordInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    passwordSubmit.click();
                }
            });
            
            // 添加震动动画
            const style = document.createElement('style');
            style.textContent = `
                @keyframes shake {
                    0%, 100% { transform: translateX(0); }
                    10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                    20%, 40%, 60%, 80% { transform: translateX(5px); }
                }
            `;
            document.head.appendChild(style);
        }
        
        // 导航功能
        function initNavigation() {
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('.section');
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const mainMenu = document.getElementById('mainMenu');
            
            // 导航菜单切换
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // 更新活动链接
                    navLinks.forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 显示目标部分
                    const targetSection = this.getAttribute('data-section');
                    sections.forEach(section => {
                        section.classList.remove('active');
                        if (section.id === targetSection) {
                            section.classList.add('active');
                        }
                    });
                    
                    // 移动端菜单隐藏
                    if (window.innerWidth <= 768) {
                        mainMenu.classList.remove('show');
                    }
                });
            });
            
            // 移动端菜单切换
            mobileMenuBtn.addEventListener('click', function() {
                mainMenu.classList.toggle('show');
            });
        }
        
        // 初始化编辑按钮
        function initEditButtons() {
            // 编辑首页按钮
            document.getElementById('edit-home-btn').addEventListener('click', function() {
                const newTitle = prompt('修改情侣名称:', '芬 ❤️ 萌');
                if (newTitle) {
                    document.querySelector('.couple-name').textContent = newTitle;
                }
                
                const newTagline = prompt('修改首页描述:', document.querySelector('.tagline').textContent);
                if (newTagline) {
                    document.querySelector('.tagline').textContent = newTagline;
                }
            });
            
            // 编辑关于她标题
            document.getElementById('edit-about-her-title').addEventListener('click', function() {
                const newTitle = prompt('修改"关于她"标题:', '关于她');
                if (newTitle) {
                    document.querySelector('#about-her .section-title').childNodes[0].textContent = newTitle;
                }
            });
            
            // 编辑纪念日标题
            document.getElementById('edit-milestones-title').addEventListener('click', function() {
                const newTitle = prompt('修改"纪念日"标题:', '纪念日');
                if (newTitle) {
                    document.querySelector('#milestones .section-title').childNodes[0].textContent = newTitle;
                }
            });
            
            // 编辑关于她卡片
            document.querySelectorAll('.edit-about-card').forEach(btn => {
                btn.addEventListener('click', function() {
                    const cardType = this.dataset.card;
                    alert(`编辑${getCardName(cardType)}功能正在开发中...`);
                });
            });
            
            // 添加关于她卡片
            document.getElementById('add-about-card').addEventListener('click', function() {
                alert('添加新卡片功能正在开发中...');
            });
            
            // 编辑底部文字
            document.getElementById('edit-footer').addEventListener('click', function() {
                const footerText = document.querySelector('footer p').textContent;
                const newText = prompt('修改底部文字:', footerText);
                if (newText) {
                    document.querySelector('footer p').textContent = newText;
                }
            });
        }
        
        // 获取卡片名称
        function getCardName(cardType) {
            switch(cardType) {
                case 'basic': return '基本信息';
                case 'likes': return '她的喜好';
                case 'dislikes': return '她的不喜欢';
                case 'story': return '我们的故事';
                default: return '卡片';
            }
        }
    </script>
</body>
</html>
